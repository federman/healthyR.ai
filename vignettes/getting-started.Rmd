---
title: "Getting Started with healthyR.ai"
subtitle: "A Quick Introduction"
author: "Steven P. Sanderson II, MPH"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_vignette:
    toc: true
    toc_depth: 2
vignette: >
  %\VignetteIndexEntry{Getting Started with healthyR.ai}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

First of all, thank you for using `healthyR.ai`. If you encounter issues or want
to make a feature request, please visit https://github.com/spsanderson/healthyR.ai/issues

```{r setup}
library(healthyR.ai)
```

In this should example we will showcase the `pca_your_recipe()` function. This
function takes only a few arguments. The arguments are currently `.data` which
is the full data set that gets passed internally to the `recipes::bake()` function,
`.recipe_object` which is a recipe you have already made and want to pass to the 
function in order to perform the pca, and finally `.threshold` which is the fraction
of the variance that should be captured by the components.

To start this walk through we will first load in a few libraries.

```{r lib_load}
suppressPackageStartupMessages(library(timetk))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(purrr))
suppressPackageStartupMessages(library(healthyR.data))
suppressPackageStartupMessages(library(rsample))
suppressPackageStartupMessages(library(recipes))
suppressPackageStartupMessages(library(ggplot2))
```

Now that we have out libraries we can go ahead and get our data set ready.

```{r data_set}
data_tbl <- healthyR_data %>%
    select(visit_end_date_time) %>%
    summarise_by_time(
        .date_var = visit_end_date_time,
        .by       = "month",
        value     = n()
    ) %>%
    set_names("date_col","value") %>%
    filter_by_time(
        .date_var = date_col,
        .start_date = "2013",
        .end_date = "2020"
    )

head(data_tbl)
```

The data set is simple and by itself would not be at all useful for a pca analysis
since there is only one predictor, being time. In order to facilitate the use of 
the function and this example, we will create a `splits` object and a `recipe` 
object.

```{r splits}
splits <- initial_split(data = data_tbl, prop = 0.8)

splits

head(training(splits))
```
